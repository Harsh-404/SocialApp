<!-- Top Navigation Bar -->
<nav class="top-nav">
    <div class="nav-brand">
        <div class="brand-icon">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2L2 7L12 12L22 7L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
                <path d="M2 17L12 22L22 17" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
                <path d="M2 12L12 17L22 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" />
            </svg>
        </div>
        <span class="brand-name">SocialApp</span>
    </div>

    <div class="nav-actions">
        <button class="nav-btn" (click)="get_profile()" title="Profile">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" />
                <circle cx="12" cy="7" r="4" />
            </svg>
            <span>Profile</span>
        </button>
        <button class="nav-btn" (click)="searchFriends()" title="Friends">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                <circle cx="9" cy="7" r="4" />
                <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                <path d="M16 3.13a4 4 0 0 1 0 7.75" />
            </svg>
            <span>Friends</span>
        </button>
        <button class="nav-btn" (click)="chat()" title="Chat">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
            </svg>
            <span>Chat</span>
        </button>
        <button class="nav-btn logout-btn" (click)="logout()" title="Logout">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                <polyline points="16 17 21 12 16 7" />
                <line x1="21" y1="12" x2="9" y2="12" />
            </svg>
            <span>Logout</span>
        </button>
    </div>
</nav>

<!-- Main Feed Layout -->
<div class="feed-wrapper">
    <!-- Create Post Card -->
    <div class="create-post-card">
        <div class="card-header">
            <div class="header-icon">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                </svg>
            </div>
            <h2>{{ isEditMode ? 'Edit Article' : 'Create New Post' }}</h2>
        </div>

        <form [formGroup]="articleForm" (ngSubmit)="submitArticle()" enctype="multipart/form-data" class="post-form">
            <div class="form-field">
                <label for="title">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                    </svg>
                    Title
                </label>
                <input id="title" formControlName="title" placeholder="Give your post a title..."
                    [class.invalid]="articleForm.controls['title'].invalid && articleForm.controls['title'].touched">
                <span class="field-error"
                    *ngIf="articleForm.controls['title'].invalid && articleForm.controls['title'].touched">
                    Title is required
                </span>
            </div>

            <div class="form-field">
                <label for="content">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <line x1="17" y1="10" x2="3" y2="10" />
                        <line x1="21" y1="6" x2="3" y2="6" />
                        <line x1="21" y1="14" x2="3" y2="14" />
                        <line x1="17" y1="18" x2="3" y2="18" />
                    </svg>
                    Content
                </label>
                <textarea id="content" formControlName="content" rows="4" placeholder="What's on your mind?"
                    [class.invalid]="articleForm.controls['content'].invalid && articleForm.controls['content'].touched"></textarea>
                <span class="field-error"
                    *ngIf="articleForm.controls['content'].invalid && articleForm.controls['content'].touched">
                    Content is required
                </span>
            </div>

            <div class="form-field file-field">
                <label for="image">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
                        <circle cx="8.5" cy="8.5" r="1.5" />
                        <polyline points="21 15 16 10 5 21" />
                    </svg>
                    Attach Image
                </label>
                <input type="file" (change)="onFileSelected($event)" id="image" accept="image/*">
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-post" [disabled]="articleForm.invalid">
                    <span>{{ isEditMode ? 'Update' : 'Post' }}</span>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <line x1="22" y1="2" x2="11" y2="13" />
                        <polygon points="22 2 15 22 11 13 2 9 22 2" />
                    </svg>
                </button>
                <button type="button" class="btn-cancel" (click)="resetForm()" *ngIf="isEditMode">
                    Cancel
                </button>
            </div>
        </form>
    </div>

    <!-- Articles Feed -->
    <div class="articles-section">
        <div class="section-header">
            <h2>Feed</h2>
            <span class="article-count">{{ articles.length }} posts</span>
        </div>

        <div class="article-card" *ngFor="let article of articles; let i = index">
            <div class="article-header">
                <div class="author-info">
                    <div class="author-avatar">
                        {{ (article.user || '?')[0] }}
                    </div>
                    <div class="author-details">
                        <span class="author-name">{{ article.user }}</span>
                        <span class="post-time">Just now</span>
                    </div>
                </div>
                <div class="article-actions" *ngIf="article.user === currentUser?.username">
                    <button class="action-btn edit-btn" (click)="loadArticleById(article.id)" title="Edit">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                        </svg>
                    </button>
                    <button class="action-btn delete-btn" (click)="deleteArticle(article.id!)" title="Delete">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <polyline points="3 6 5 6 21 6" />
                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                        </svg>
                    </button>
                </div>
            </div>

            <div class="article-body">
                <h3 class="article-title">{{ article.title }}</h3>
                <p class="article-content">{{ article.content }}</p>
            </div>

            <div class="article-image" *ngIf="article.image">
                <img [src]="article.image" [alt]="article.title">
            </div>

            <div class="article-footer">
                <button class="footer-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path
                            d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z" />
                    </svg>
                    <span>Like</span>
                </button>
                <button class="footer-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                    </svg>
                    <span>Comment</span>
                </button>
                <button class="footer-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2">
                        <circle cx="18" cy="5" r="3" />
                        <circle cx="6" cy="12" r="3" />
                        <circle cx="18" cy="19" r="3" />
                        <line x1="8.59" y1="13.51" x2="15.42" y2="17.49" />
                        <line x1="15.41" y1="6.51" x2="8.59" y2="10.49" />
                    </svg>
                    <span>Share</span>
                </button>
            </div>
        </div>

        <!-- Empty State -->
        <div class="empty-state" *ngIf="articles.length === 0">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                stroke-width="1.5">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                <polyline points="14 2 14 8 20 8" />
                <line x1="16" y1="13" x2="8" y2="13" />
                <line x1="16" y1="17" x2="8" y2="17" />
                <polyline points="10 9 9 9 8 9" />
            </svg>
            <h3>No posts yet</h3>
            <p>Be the first to share something!</p>
        </div>
    </div>
</div>